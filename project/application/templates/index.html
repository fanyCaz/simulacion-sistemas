<!DOCTYPE html>
<head>
    <title>MYSSD</title>
    <link rel="stylesheet" href="{{ url_for('static',filename='css/index.css') }}">
</head>
<body>
    <div class="titulos">
        <h1>Modelado y Simulación de Sistemas Dinámicos</h1>
        <h3>Historial de contaminantes en Monterrey y su área metropolitana</h3>
        <p>Contaminante: </p>
    </div>
    <div class="contenedor-info">
        <button id="btn-get-datos">traer datos</button>
        <div class="mapa">
            <div id="contaminante-pm10" class="grafica-contaminante"></div>
            <!-- <canvas class="border-canvas" id="tuto" width="150" height="150"></canvas>  -->
            <!-- <canvas class="border-canvas" id="puntos" width="706" height="410"></canvas> -->
        </div>
    </div>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>

        PRUEBA = document.getElementById('contaminante-pm10');
        Plotly.newPlot(PRUEBA,[{
            x: [1,2,4,5,6],
            y: [1,3,5,6,7] } ],
            {
                margin: {t : 0}
            }
        );
        
        //con este botón, se manda a llamar la función en back para traer los valores
        let btnGetValues = document.getElementById('btn-get-datos');
            btnGetValues.addEventListener('click',()=>{
                console.log("siosijfaoij");
                xhttp = new XMLHttpRequest();
                xhttp.open("GET","{{ url_for('datosMes', mes='05',contaminante='PM10') }}",true);
                xhttp.send();
                xhttp.onreadystatechange = () =>{
                    console.log(xhttp.readyState);
                    console.log('pues pruebaaa');
                    if(xhttp.readyState == XMLHttpRequest.DONE){
                        console.log("received, yei");
                        if(xhttp.status == 200){
                            console.log("si traer bien");
                            var response = JSON.parse( xhttp.responseText );
                            console.log(response);

                        }else{
                            console.log("no lo trajo bien, hay error");
                        }
                    }else{
                        console.log("not yet, wait for it");
                    }
                };
            });

        let drawPaht = () =>{
            var canvas = document.getElementById("puntos");
            var context = canvas.getContext('2d');
            if(canvas.getContext){
                //Background is static
                var b64 = canvas.toDataURL();
                canvas.style.backgroundImage = 'url(' + "{{ url_for('static', filename='images/espacio.png') }}" + ")";
                
                let xPos = 100, yPos = 100;
                    
                var t = setInterval(()=>{
                    if(xPos > canvas.clientWidth || yPos > canvas.clientHeight){
                        clearInterval(t);
                    }
                    context.beginPath();
                    context.arc(xPos,yPos,20,0,2*Math.PI);
                    context.fillStyle = 'rgb(128,128,128)';
                    context.fill();
                    xPos += 60;
                    yPos += 60;
                    console.log("sigue...");
                }, 1000);

                context.beginPath();
                context.arc(55,55,50,0,2 * Math.PI);    //x,y,inicio angulo,fin angulo,parte de círculo
                
                context.stroke();
            }else{
                console.log("nah");
            }
        }

        let draw = ()=>{
            var canvas = document.getElementById("tuto");
            if(canvas.getContext){
                var context = canvas.getContext('2d');
                context.fillStyle = 'rgb(200,0,0)';
                context.fillRect(10,10,50,50);  //de rojo solo esta parte de los pixeles

                context.fillStyle = 'rgba(0,0,200,0.5)';
                context.fillRect(30,30,50,50);

                context.strokeRect(20,20,90,09);
                context.clearRect(20,25,20,20);
                
            }else{
                console.log("boo too bad")
            }
        }
        //draw();
        //drawPaht();
        //window.onload(draw);
        
    </script>
</body>